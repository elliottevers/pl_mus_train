{"version":3,"file":"parse.js","sourceRoot":"","sources":["../../src/parse/parse.ts"],"names":[],"mappings":"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","sourcesContent":["import {segment} from \"../segment/segment\";\n\nconst _ = require(\"underscore\");\n\n\nexport namespace parse {\n    import SegmentIterator = segment.SegmentIterator;\n\n    export interface Parsable {\n        choose(): boolean;\n\n        // TODO: annotation\n        get_best_candidate(list_candidate_note);\n    }\n\n    export class TreeDepthIterator {\n        public direction_forward: boolean;\n        private i: number;\n        private layers: number[];\n\n        constructor(depth: number, direction_forward: boolean) {\n            this.layers = _.range(1, depth);\n            this.direction_forward = direction_forward;\n            this.i = -1;\n        }\n\n        // TODO: type declarations\n        public next() {\n            let value_increment = (this.direction_forward) ? 1 : -1;\n\n            this.i += value_increment;\n\n            if (this.i < 0) {\n                throw 'segment iterator < 0'\n            }\n\n            if (this.i < this.layers.length) {\n                return {\n                    value: this.layers[this.i],\n                    done: false\n                }\n            } else {\n                return {\n                    value: null,\n                    done: true\n                }\n            }\n        }\n\n        public current() {\n            if (this.i > -1) {\n                return this.layers[this.i];\n            } else {\n                return null;\n            }\n        }\n    }\n\n    export class ParseTreeIterator {\n        private iterator_segment;\n        private iterator_tree;\n        public current;\n        public layer_current;\n\n        constructor(iterator_segment: SegmentIterator, iterator_tree: TreeDepthIterator) {\n            this.iterator_segment = iterator_segment;\n            this.iterator_tree = iterator_tree\n        }\n\n        // TODO: type declarations\n        public next() {\n\n            // let layer_current = this.iterator_tree.current();\n\n            let segment_result_next = this.iterator_segment.next();\n\n            let segment_next = segment_result_next.value;\n\n            if (!segment_result_next.done) {\n                this.current = segment_next;\n                return {\n                    value: this.current,\n                    done: false\n                }\n            }\n\n            //\n            // this.iterator_segment.reset();\n\n            let layer_result_next = this.iterator_tree.next();\n\n            // segment_next.done is true by now\n            if (!layer_result_next.done) {\n\n                this.iterator_segment.reset();\n\n                this.layer_current = this.iterator_tree.current();\n\n                segment_result_next = this.iterator_segment.next();\n\n                segment_next = segment_result_next.value;\n\n                this.current = segment_next;\n\n                return {\n                    value: this.current,\n                    done: false\n                }\n            }\n\n            return {\n                value: null,\n                done: true\n            }\n        }\n    }\n}"]}