{"version":3,"file":"test.js","sourceRoot":"","sources":["../src/test.ts"],"names":[],"mappings":"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","sourcesContent":["import {log} from \"./log/logger\";\nimport Logger = log.Logger;\nimport {message} from \"./message/messenger\";\nimport Messenger = message.Messenger;\nimport {execute} from \"./execute/executor\";\nimport SynchronousDagExecutor = execute.SynchronousDagExecutor;\n\ndeclare let autowatch: any;\ndeclare let inlets: any;\ndeclare let outlets: any;\ndeclare function outlet(n: number, o: any): void;\ndeclare function post(message?: any): void;\n\nexport {}\n\ndeclare let Global: any;\n\nlet env: string = 'max';\n\nif (env === 'max') {\n    post('recompile successful');\n    autowatch = 1;\n}\n\n\nenum Mode {\n    Stream = 'stream',\n    BulkWrite = 'bulk_write',\n    Query = 'query'\n}\n\nlet executor: any;\n\nlet messenger: Messenger;\n\nlet scale_factor: number;\n\nlet length_coll: number;\n\nlet max_coll: number;\n\nlet min_coll: number;\n\nlet testing = 1;\n\n\n// // TODO: sends message with (name of method being executed), ...\n// let executor = new SynchronousDagExecutor(\n//     {'set_mode': Mode.Query},\n//     {'get_length_coll': null},\n//     {'get_min_coll': null},\n//     {'get_max_coll': null},\n//     {'set_scale_factor': scale_factor},\n//     {'set_mode': Mode.BulkWrite},\n//     {'dump_coll': null},\n//     {'set_mode': Mode.Stream}\n// );\n\n// let process_response = (envoker, response) => {\n//\n// };\n\nlet init = () => {\n    call_set_mode(Mode.Query)\n};\n\nlet call_set_mode = (mode) => {\n    switch (mode) {\n        case Mode.Query: {\n            messenger.message(['set_mode', Mode.Query]);\n            break;\n        }\n\n        case Mode.BulkWrite: {\n            messenger.message(['set_mode', Mode.BulkWrite]);\n            break;\n        }\n\n        case Mode.Stream: {\n            messenger.message(['set_mode', Mode.Stream]);\n            break;\n        }\n    }\n};\n\nlet return_set_mode = (arg_invoker, val_return) => {\n    switch (arg_invoker) {\n        case Mode.Query: {\n            call_get_length();\n            break;\n        }\n\n        case Mode.BulkWrite: {\n            call_dump_coll();\n            break;\n        }\n\n        case Mode.Stream: {\n            break;\n        }\n\n    }\n};\n\n// let call_set_mode_query = () => {\n//     messenger.message(['set_mode', Mode.Query])\n// };\n//\n// let return_set_mode = (val) => {\n//     call_get_length()\n// };\n\nlet call_get_length = () => {\n    messenger.message(['get_length', 'length'])\n};\n\nlet return_get_length = (val) => {\n    length_coll = val;\n    call_get_min()\n};\n\nlet call_get_min = () => {\n    messenger.message(['get_min', 'min'])\n};\n\nlet return_get_min = (val) => {\n    min_coll = val;\n    call_get_max()\n};\n\nlet call_get_max = () => {\n    messenger.message(['get_max', 'max'])\n};\n\nlet return_get_max = (val) => {\n    min_coll = val;\n    call_set_scale_factor()\n};\n\nlet call_set_scale_factor = () => {\n    messenger.message(['set_scale_factor', max_coll + 100])\n};\n\nlet return_set_scale_factor = (val) => {\n    call_set_mode(Mode.BulkWrite)\n};\n\n// let call_set_mode_bulk_write = () => {\n//     messenger.message(['set_mode', Mode.BulkWrite])\n// };\n//\n// let return_set_mode_bulk_write = (val) => {\n//     call_dump_coll()\n// };\n\nlet call_dump_coll = () => {\n    messenger.message(['dump_coll'])\n};\n\nlet return_dump_coll = (val) => {\n    call_set_mode(Mode.Stream)\n};\n\n// let call_set_mode_stream = () => {\n//     messenger.message(['set_mode', Mode.Stream])\n// };\n\n// [\"test1\", \"test2\"].forEach(function(name){eval(name + \"()\")})\n\nlet invoke_sequentially = (name_funcs: string[]) => {\n    name_funcs.forEach(function(name){\n        // send message\n        // wait for ack\n        // eval(name + \"()\")\n    })\n};\n\n// declare let __router: any;\n//\n// declare let __coll: any;\n\nlet receives = (name_method, val_return) => {\n    executor.return(name_method, val_return)\n\n};\n\nlet sends = (name_method, arg_method) => {\n    executor.call(name_method, arg_method)\n};\n\nlet main = () => {\n    // set router to query mode\n\n    // query coll length\n\n    // wait for response, with guarantee that no other responses could come back except that one\n\n    // query coll max\n\n    // wait\n\n    // query coll min\n\n    // wait\n\n    // calculate metadata\n\n    // set scale factor\n\n    // set router to bulk write mode\n\n    // send coll \"dump\"\n\n    // after last value is written, set route to stream mode\n\n    post('testing...');\n    post('\\n');\n    post(this.testing);\n};\n\nmain();\n\n\nlet set_state_channels = (mode) => {\n    // sends messages to configure gates\n};\n\nif (typeof Global !== \"undefined\") {\n    Global.test = {};\n    Global.test.main = main;\n}\n"]}