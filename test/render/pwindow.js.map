{"version":3,"file":"pwindow.js","sourceRoot":"","sources":["pwindow.ts"],"names":[],"mappings":"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","sourcesContent":["import \"mocha\";\nconst assert = require(\"chai\").assert;\nconst sinon = require(\"sinon\");\nconst sinonTest = require('sinon-test');\nconst test = sinonTest(sinon);\nimport {clip as c} from \"../../src/clip/clip\";\nimport {message as m} from \"../../src/message/messenger\";\nimport {window as w} from \"../../src/render/window\";\nimport {note as n} from \"../../src/note/note\";\nimport TreeModel = require(\"tree-model\");\n\ndescribe('Pwindow', test(()=>{\n\n    it('incrementally renders tree (does not need to render an entire clip at once)', test(()=>{\n        let env: string = 'node';\n\n        let pwindow = new w.Pwindow(\n            60,\n            8,\n            new m.Messenger(env, 0)\n        );\n\n        let tree: TreeModel = new TreeModel();\n        // 50,0,4,127,0\n        let note_root = tree.parse(\n            {\n                id: -1, // TODO: hashing scheme for clip id and beat start\n                note: new n.Note(\n                    50,\n                    0,\n                    4,\n                    127,\n                    0\n                ),\n                children: [\n\n                ]\n            }\n        );\n\n        let note_2_1 = tree.parse(\n            {\n                id: -1, // TODO: hashing scheme for clip id and beat start\n                note: new n.Note(\n                    50,\n                    0,\n                    2,\n                    127,\n                    0\n                ),\n                children: [\n\n                ]\n            }\n        );\n\n        let note_2_2 = tree.parse(\n            {\n                id: -1, // TODO: hashing scheme for clip id and beat start\n                note: new n.Note(\n                    54,\n                    2,\n                    2,\n                    127,\n                    0\n                ),\n                children: [\n\n                ]\n            }\n        );\n\n        let note_3_1 = tree.parse(\n            {\n                id: -1, // TODO: hashing scheme for clip id and beat start\n                note: new n.Note(\n                    50,\n                    0,\n                    1,\n                    127,\n                    0\n                ),\n                children: [\n\n                ]\n            }\n        );\n\n        let note_3_2 = tree.parse(\n            {\n                id: -1, // TODO: hashing scheme for clip id and beat start\n                note: new n.Note(\n                    52,\n                    1,\n                    2,\n                    127,\n                    0\n                ),\n                children: [\n\n                ]\n            }\n        );\n\n        let note_3_3 = tree.parse(\n            {\n                id: -1, // TODO: hashing scheme for clip id and beat start\n                note: new n.Note(\n                    54,\n                    2,\n                    3,\n                    127,\n                    0\n                ),\n                children: [\n\n                ]\n            }\n        );\n\n        let note_3_4 = tree.parse(\n            {\n                id: -1, // TODO: hashing scheme for clip id and beat start\n                note: new n.Note(\n                    55,\n                    3,\n                    4,\n                    127,\n                    0\n                ),\n                children: [\n\n                ]\n            }\n        );\n\n\n        pwindow.set_root(note_root);\n\n        pwindow.elaborate(\n            [note_2_1],\n            0,\n            2,\n            1\n        );\n\n        pwindow.elaborate(\n            [note_2_2],\n            2,\n            4,\n            1\n        );\n\n        pwindow.elaborate(\n            [note_3_1],\n            0,\n            1,\n            2\n        );\n\n        pwindow.elaborate(\n            [note_3_2],\n            1,\n            2,\n            2\n        );\n\n        pwindow.elaborate(\n            [note_3_3],\n            2,\n            3,\n            2\n        );\n\n        pwindow.elaborate(\n            [note_3_4],\n            3,\n            4,\n            2\n        );\n\n\n        let messages = pwindow.get_messages_render_tree();\n\n        return;\n\n        // TODO: tack on colors to end of message, make color configurable\n        // TODO: make order of messages not matter\n        assert.deepEqual(\n            messages[4],\n            ['linesegment', 240, 312, 288, 105.6, 255, 0, 0],\n        );\n\n        assert.deepEqual(\n            messages[5],\n            ['linesegment', 336, 296, 288, 105.6, 255, 0, 0],\n        );\n\n        assert.deepEqual(\n            messages[0],\n            ['linesegment', 96, 182.4, 192, 48, 255, 0, 0],\n        );\n\n        assert.deepEqual(\n            messages[1],\n            ['linesegment', 288, 105.6, 192, 48, 255, 0, 0],\n        );\n\n        assert.deepEqual(\n            messages[2],\n            ['linesegment', 48, 278.4, 96, 182.4, 255, 0, 0]\n        );\n\n        assert.deepEqual(\n            messages[3],\n            ['linesegment', 144, 240, 96, 182.4, 255, 0, 0],\n        );\n    }));\n}));"]}