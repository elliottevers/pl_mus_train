{"version":3,"file":"scripts.node.max_python_cli.js","sourceRoot":"","sources":["scripts.node.max_python_cli.ts"],"names":[],"mappings":"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","sourcesContent":["import {cli} from \"../cli/cli\";\nconst _ = require('underscore');\nconst max_api = require('max-api');\nimport {PythonShell} from 'python-shell';\n\nlet args: cli.Arg[] = [];\nlet options: cli.Option[] = [];\nlet flags: cli.Flag[] = [];\n\nlet options_python_shell;\n\nlet path_script;\n\nlet path_interpreter = '/Users/elliottevers/DocumentsTurbulent/venvwrapper/master_36/bin/python';\n\nlet dir_scripts_python = '/Users/elliottevers/Documents/DocumentsSymlinked/git-repos.nosync/music/src/scripts/';\n\n\nmax_api.addHandler(\"set_arg\", (name_arg, val_arg) => {\n    if (_.contains(args.map((arg) => {return arg.name}), name_arg)) {\n        let arg_existing = args.filter(arg => arg.name === name_arg)[0];\n        arg_existing.set(val_arg);\n    } else {\n        let arg = new cli.Arg(name_arg);\n        arg.set(val_arg);\n        args.push(arg);\n    }\n});\n\nmax_api.addHandler(\"set_flag\", (name_flag, val_flag) => {\n    if (_.contains(flags.map((flag) => {return flag.name}), name_flag)) {\n        let flag_existing = flags.filter(flag => flag.name === name_flag)[0];\n        flag_existing.set(val_flag);\n    } else {\n        let flag = new cli.Flag(name_flag);\n        flag.set(val_flag);\n        flags.push(flag);\n    }\n});\n\nmax_api.addHandler(\"set_option\", (name_opt, val_opt) => {\n    if (_.contains(options.map((opt) => {return opt.name}), name_opt)) {\n        let opt_existing = options.filter(opt => opt.name === name_opt)[0];\n        opt_existing.set(val_opt);\n    } else {\n        let opt = new cli.Option(name_opt, false, false, true);\n        opt.set(val_opt);\n        options.push(opt);\n    }\n});\n\nmax_api.addHandler(\"set_path_interpreter\", (path) => {\n    path_interpreter = path\n});\n\nmax_api.addHandler(\"set_path_script\", (filename_script) => {\n    path_script = dir_scripts_python + filename_script\n});\n\n\n// let opt = new cli.Option('s', false, false, false);\n// opt.set(0);\n// options.push(opt);\n//\n//\n// let opt2 = new cli.Option('e', false, false, false);\n// opt2.set(200);\n// options.push(opt2);\n//\n// path_script = dir_scripts_python + 'extract_beatmap.py';\n//\n// let flag = new cli.Flag('m');\n// flag.set(1);\n// flags.push(flag);\n\n\nlet run = () => {\n\n    let script = new cli.Script(\n        path_interpreter,\n        path_script,\n        flags,\n        options,\n        args\n    );\n\n    let parameters_exist = !!script.get_run_parameters().split(' ')[0];\n\n    options_python_shell = {\n        mode: 'text',\n        pythonPath: path_interpreter,\n    };\n\n    if (parameters_exist) {\n        options_python_shell['args'] = script.get_run_parameters().split(' ')\n    }\n\n    PythonShell.run(script.script, options_python_shell, function (err, results) {\n        if (err) throw err;\n        // results is an array consisting of messages collected during execution\n        for (let result of results) {\n            let message_trimmed = result.toString().trim();\n            let message_split = message_trimmed.split(' ');\n            max_api.outlet(message_split)\n        }\n        // console.log(results)\n    });\n};\n\n\nmax_api.addHandler(\"run\", () => {\n    run()\n});\n\n// run();\n"]}