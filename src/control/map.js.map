{"version":3,"file":"map.js","sourceRoot":"","sources":["map.ts"],"names":[],"mappings":"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","sourcesContent":["import {message} from \"../message/messenger\";\nimport {control} from \"./control\";\nconst _ = require(\"underscore\");\n\nexport namespace map {\n\n    export class FretMapper {\n\n        coordinate_last_played: number[];\n\n        root = {\n            6: 3\n        };\n\n        messenger;\n\n        map_generic_interval = {\n            1: 6,\n            2: 6,\n            3: 6,\n            4: 5,\n            5: 5,\n            6: 5,\n            7: 4,\n            8: 4,\n            9: 4,\n            10: 3,\n            11: 3,\n            12: 3,\n            13: 2,\n            14: 2,\n            15: 2,\n            16: 1,\n            17: 1,\n            18: 1\n        };\n\n        strings = {\n            6: _.range(control.string_to_root_note_map[6], 12),\n            5: _.range(control.string_to_root_note_map[5], 12),\n            4: _.range(control.string_to_root_note_map[4], 12),\n            3: _.range(control.string_to_root_note_map[3], 12),\n            2: _.range(control.string_to_root_note_map[2], 12),\n            1: _.range(control.string_to_root_note_map[1], 12)\n        };\n\n        constructor(messenger) {\n            // TODO: create 'config' that generates 'root', 'map_generic_interval', 'notes_per_string'\n            this.messenger = messenger;\n        }\n\n        play(note_midi) {\n            let coordinate = this.map(note_midi);\n            this.messenger.message(this.coordinate_last_played.push(0));\n            this.messenger.message(coordinate.push(1));\n            this.coordinate_last_played = coordinate;\n        }\n\n        private get_index_string(interval_generic) {\n            if (interval_generic > 18) {\n                return 1\n            } else if (interval_generic < 1) {\n                return 6\n            } else {\n                return this.map_generic_interval[interval_generic]\n            }\n        }\n\n        map(note_midi) {\n            let index_string = this.get_index_string(\n                FretMapper.get_interval_generic(\n                    FretMapper.get_interval(\n                        note_midi,\n                        this.root[6]\n                    )\n                )\n            );\n\n            let position_fret = this.strings[index_string].indexOf(note_midi);\n\n            return [index_string, position_fret]\n        }\n\n        static get_interval(lower, upper) {\n            return (upper - lower) % 12\n        }\n\n        static get_interval_generic(interval) {\n            switch (interval) {\n                case 0: {\n                    return 1\n                }\n                case 1: {\n                    return 2\n                }\n                case 2: {\n                    return 2\n                }\n                case 3: {\n                    return 3\n                }\n                case 4: {\n                    return 3\n                }\n                case 5: {\n                    return 4\n                }\n                case 6: {\n                    return 5\n                }\n                case 7: {\n                    return 5\n                }\n                case 8: {\n                    return 6\n                }\n                case 9: {\n                    return 6\n                }\n                case 10: {\n                    return 7\n                }\n                case 11: {\n                    return 7\n                }\n            }\n        }\n    }\n}"]}