{"version":3,"file":"clip_slot.js","sourceRoot":"","sources":["clip_slot.ts"],"names":[],"mappings":"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","sourcesContent":["import {live} from \"../live/live\";\nimport {clip, clip as module_clip} from \"../clip/clip\";\nimport {message} from \"../message/messenger\";\n// import {log} from \"../log/logger\";\nimport LiveApiJs = live.LiveApiJs;\nimport {utils} from \"../utils/utils\";\nimport {log} from \"../log/logger\";\n\nexport namespace clip_slot {\n    import Clip = module_clip.Clip;\n    // import ClipDao = module_clip.ClipDao;\n    import Messenger = message.Messenger;\n    import ClipDao = clip.ClipDao;\n    import Logger = log.Logger;\n    import LiveClipVirtual = live.LiveClipVirtual;\n    // import Logger = log.Logger;\n\n    export class ClipSlot {\n\n        clip: Clip;\n\n        clip_slot_dao: iClipSlotDao;\n\n        constructor(clip_slot_dao: iClipSlotDao) {\n            this.clip_slot_dao = clip_slot_dao;\n        }\n\n        b_has_clip(): boolean {\n            return this.clip_slot_dao.has_clip()\n        }\n\n        delete_clip(): void {\n            this.clip_slot_dao.delete_clip()\n        }\n\n        duplicate_clip_to(clip_slot: ClipSlot): void {\n            this.clip_slot_dao.duplicate_clip_to(clip_slot.get_id())\n        }\n\n        get_id(): number {\n            return this.clip_slot_dao.get_id()\n        }\n\n        create_clip(length_beats: number): void {\n            this.clip_slot_dao.create_clip(length_beats);\n        }\n\n        load_clip(): void {\n            if (this.b_has_clip()) {\n                this.clip = this.clip_slot_dao.get_clip();\n            }\n        }\n\n        // TODO: we should consider checking whether it exists here\n        get_clip(): Clip {\n            return this.clip\n        }\n    }\n\n    interface iClipSlotDao {\n\n        delete_clip()\n\n        has_clip()\n\n        duplicate_clip_to(id: number)\n\n        get_clip(): Clip\n\n        get_path()\n\n        get_id()\n\n        create_clip(length_beats: number): void\n\n    }\n\n    export class ClipSlotDaoVirtual implements iClipSlotDao {\n\n        private clip: Clip;\n\n        constructor(clip: Clip) {\n            this.clip = clip;\n        }\n\n        create_clip(length_beats: number): void {\n            throw 'error'\n        }\n\n        delete_clip() {\n            throw 'error'\n        }\n\n        duplicate_clip_to(id: number) {\n            throw 'error'\n        }\n\n        get_clip(): clip.Clip {\n            return this.clip\n        }\n\n        get_id() {\n            throw 'error'\n        }\n\n        get_path() {\n            throw 'error'\n        }\n\n        has_clip() {\n            return true\n        }\n    }\n\n    export class ClipSlotDao implements iClipSlotDao {\n\n        private live_api: LiveApiJs;\n        private messenger: Messenger;\n\n        constructor(live_api: LiveApiJs, messenger: Messenger) {\n            this.live_api = live_api;\n            this.messenger = messenger;\n        }\n\n        create_clip(length_beats: number) {\n            this.live_api.call(\"create_clip\", String(length_beats))\n        }\n\n        delete_clip() {\n            this.live_api.call(\"delete_clip\")\n        }\n\n        has_clip() {\n            return this.live_api.get(\"has_clip\")[0] === 1\n        }\n\n        duplicate_clip_to(id: number) {\n            this.live_api.call(\"duplicate_clip_to\", ['id', id].join(' '));\n        }\n\n        get_clip(): Clip {\n            // let logger = new Logger('max');\n            // logger.log(utils.cleanse_id(this.live_api.get('clip')));\n            return new Clip(\n                new ClipDao(\n                    new LiveApiJs(\n                        utils.cleanse_id(this.live_api.get('clip'))\n                    ),\n                    this.messenger\n                )\n            )\n        }\n\n        get_path(): string {\n            return utils.cleanse_path(this.live_api.get_path())\n        }\n\n        get_id(): number {\n            return this.live_api.get_id()\n        }\n    }\n}"]}