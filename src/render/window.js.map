{"version":3,"file":"window.js","sourceRoot":"","sources":["window.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAEA,qCAA6C;AAE7C,qCAAkC;AAClC,0BAA4B;AAM5B,IAAiB,MAAM,CA4btB;AA5bD,WAAiB,MAAM;IAEnB,IAAO,eAAe,GAAG,WAAI,CAAC,eAAe,CAAC;IAQ9C,IAAM,GAAG,GAAG,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACxB,IAAM,KAAK,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IAC9B,IAAM,KAAK,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACxB,IAAM,aAAa,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;IACrC,IAAM,YAAY,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;IAClC,IAAM,UAAU,GAAG,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC/B,IAAM,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,CAAC;IAQ3B;QAQI,gBAAsB,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS;YAuGzD,kBAAa,GAAG,UAAU,IAAY;gBAClC,IAAI,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC;gBAClC,OAAO,IAAI,GAAG,CAAC,gBAAgB,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC;YACzD,CAAC,CAAC;YAzGE,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC/B,CAAC;QAEM,sBAAK,GAAZ;YACI,IAAI,SAAS,GAAG,CAAC,OAAO,CAAC,CAAC;YAC1B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACtC,CAAC;QAED,iCAAiC;QAC1B,oCAAmB,GAA1B,UAA2B,KAAK;YAC5B,IAAI,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,EAAE;gBAC7B,OAAO,CAAC,CAAA;aACX;iBAAM;gBACH,IAAI,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;oBACjB,OAAO,CAAC,CAAA;iBACX;qBAAM;oBACH,OAAO,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;iBACtB;aACJ;QACL,CAAC;QAEM,iCAAgB,GAAvB,UAAwB,SAAoB,EAAE,QAAmB;YAC7D,IAAI,UAAU,GAAG,EAAE,CAAC;YACpB,IAAI,KAAK,GAAG,SAAS,CAAC,SAAS,EAAE,CAAC;YAClC,IAAI,eAAe,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC;YAC7C,IAAI,aAAa,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC;YAE3D,IAAI,SAAS,CAAC,UAAU,EAAE,EAAE;gBACxB,IAAI,gBAAgB,GAAG,IAAI,eAAe,CAAC,EAAE,CAAC,CAAC;gBAC/C,gBAAgB,CAAC,UAAU,GAAG,eAAe,CAAC;gBAC9C,gBAAgB,CAAC,QAAQ,GAAG,aAAa,CAAC;gBAC1C,IAAI,YAAY,GAAG,IAAI,WAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;gBAChD,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;aAChC;iBAAM;gBACH,KAAK,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,EAAE;oBACjC,IAAI,gBAAgB,GAAG,IAAI,eAAe,CAAC,EAAE,CAAC,CAAC;oBAC/C,gBAAgB,CAAC,UAAU,GAAG,eAAe,CAAC;oBAC9C,gBAAgB,CAAC,QAAQ,GAAG,aAAa,CAAC;oBAC1C,IAAI,YAAY,GAAG,IAAI,WAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;oBAChD,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;iBAChC;aACJ;YAED,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QACjC,CAAC;QAEM,iCAAgB,GAAvB,UAAwB,KAAK;YACzB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;QAC9B,CAAC;QAEM,kCAAiB,GAAxB,UAAyB,oBAAoB,EAAE,aAAa;YACxD,IAAI,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,aAAa,CAAC,CAAC;YACzD,KAAiB,UAAoB,EAApB,6CAAoB,EAApB,kCAAoB,EAApB,IAAoB,EAAE;gBAAlC,IAAI,IAAI,6BAAA;gBACT,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aAC5C;QACL,CAAC;QAED,sCAAqB,GAArB,UAAsB,IAAI;YACtB,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,CACxB,CAAC,IAAI,CAAC,CACT,CAAA;QACL,CAAC;QAED,yCAAwB,GAAxB,UAAyB,UAAkB;YACvC,IAAI,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;YAC/C,IAAI,WAAW,GAAG,EAAE,CAAC;YACrB,KAAiB,UAA6C,EAA7C,KAAA,YAAY,CAAC,8BAA8B,EAAE,EAA7C,cAA6C,EAA7C,IAA6C,EAAE;gBAA3D,IAAI,IAAI,SAAA;gBACT,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,uBAAuB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC;aACpE;YACD,OAAO,WAAW,CAAC,GAAG,CAAC,UAAU,MAAM;gBACnC,IAAI,OAAO,GAAQ,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;gBAChD,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBAChC,OAAO,OAAO,CAAC;YACnB,CAAC,CAAC,CAAA;QACN,CAAC;QAAA,CAAC;QAEF,wCAAuB,GAAvB,UAAwB,IAA4B,EAAE,UAAkB;YACpE,IAAI,yBAAyB,EAAE,sBAAsB,EAAE,uBAAuB,EAAE,yBAAyB,CAAC;YAE1G,yBAAyB,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChF,uBAAuB,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YAC/G,sBAAsB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;YACnF,yBAAyB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,EAAE,UAAU,CAAC,CAAC;YAE1F,OAAO,CAAC,yBAAyB,EAAE,sBAAsB,EAAE,uBAAuB,EAAE,yBAAyB,CAAC,CAAA;QAClH,CAAC;QAAA,CAAC;QAEF,kCAAiB,GAAjB,UAAkB,KAAa,EAAE,UAAkB;YAC/C,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;YACvC,IAAI,MAAM,GAAG,UAAU,CAAC;YACxB,+BAA+B;YAC/B,IAAI,KAAK,EAAE;gBACP,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,GAAG,UAAU,CAAC;aAEpD;YACD,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,KAAK,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;YAC7E,OAAO,IAAI,GAAG,CAAC,IAAI,CAAC,eAAe,EAAE,GAAG,MAAM,CAAC,CAAC;QACpD,CAAC;QAAA,CAAC;QAOF,mCAAkB,GAAlB,UAAmB,IAAY;YAC3B,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QACpC,CAAC;QAAA,CAAC;QAEF,0CAAyB,GAAzB;YACI,OAAO,CAAC,CAAC;QACb,CAAC;QAED,yCAAwB,GAAxB;YACI,OAAO,CAAC,CAAC;QACb,CAAC;QAED,2CAA0B,GAA1B;YACI,OAAO,IAAI,CAAC,KAAK,CAAC;QACtB,CAAC;QAED,4CAA2B,GAA3B;YACI,OAAO,IAAI,CAAC,MAAM,CAAC;QACvB,CAAC;QAED,gCAAe,GAAf;YACI,OAAO,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC;QAChD,CAAC;QAAA,CAAC;QAEF,gCAAe,GAAf,UAAgB,UAAkB;YAC9B,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;YACvC,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;YACjC,IAAI,UAAU,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;YAE7C,2DAA2D;YAC3D,IAAI,UAAU,KAAK,CAAC,EAAE;gBAClB,UAAU,GAAG,CAAC,CAAC;aAClB;YACD,OAAO,IAAI,CAAC,eAAe,EAAE,GAAG,UAAU,CAAC;QAC/C,CAAC;QAAA,CAAC;QACN,aAAC;IAAD,CAAC,AAvJD,IAuJC;IAvJqB,aAAM,SAuJ3B,CAAA;IAaD;QAAkC,gCAAM;QAEpC,sBAAY,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS;mBAC3C,kBAAM,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS,CAAC;QAC9C,CAAC;QAEM,6BAAM,GAAb,UAAc,qBAAqB,EAAE,oBAAoB,EAAE,SAAS,EAAE,YAAY;YAC9E,IAAI,CAAC,KAAK,EAAE,CAAC;YAEb,oBAAoB;YACpB,EAAE;YACF,gCAAgC;YAChC,yDAAyD;YACzD,wEAAwE;YACxE,2FAA2F;YAC3F,gCAAgC;YAChC,UAAU;YACV,WAAW;YACX,yDAAyD;YACzD,yCAAyC;YACzC,8DAA8D;YAC9D,IAAI;YAEJ,IAAI,CAAC,cAAc,CACf,qBAAqB,EACrB,oBAAoB,EACpB,SAAS,EACT,YAAY,CACf,CAAC;YAEF,IAAI,SAAS,CAAC,UAAU,EAAE,EAAE;gBACxB,IAAI,CAAC,YAAY,CACb,qBAAqB,EACrB,IAAI,CACP,CAAC;aACL;iBAAM;gBACH,IAAI,CAAC,YAAY,CACb,YAAY,CACf,CAAC;gBACF,IAAI,CAAC,YAAY,CACb,qBAAqB,EACrB,YAAY,CACf,CAAC;aACL;QACL,CAAC;QAEM,mCAAY,GAAnB,UAAoB,YAAY;YAC5B,IAAI,qBAAqB,GAAG,IAAI,CAAC,yBAAyB,CAAC,YAAY,CAAC,CAAC;YACzE,KAAyB,UAAqB,EAArB,+CAAqB,EAArB,mCAAqB,EAArB,IAAqB,EAAE;gBAA3C,IAAI,YAAY,8BAAA;gBACjB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,CAAA;aACvC;QACL,CAAC;QAEM,gDAAyB,GAAhC,UAAiC,YAAY;YAA7C,iBA0CC;YAxCG,IAAI,KAAe,CAAC;YACpB,IAAI,QAAQ,GAAU,EAAE,CAAC;YACzB,IAAI,OAAc,CAAC;YAEnB,KAAkB,UAAyB,EAAzB,KAAA,YAAY,CAAC,YAAY,EAAzB,cAAyB,EAAzB,IAAyB,EAAE;gBAAxC,IAAI,KAAK,SAAA;gBACV,IAAI,gBAAgB,SAAA,CAAC;gBACrB,IAAI,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;oBACjB,gBAAgB,GAAG,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,CAAA;iBAC/C;qBAAM;oBACH,gBAAgB,GAAG,YAAY,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;iBAC7D;gBAED,KAAiB,UAAgB,EAAhB,qCAAgB,EAAhB,8BAAgB,EAAhB,IAAgB,EAAE;oBAA9B,IAAI,IAAI,yBAAA;oBACT,IAAI,CAAC,IAAI,CAAC,UAAC,IAAI;wBAEX,IAAI,IAAI,CAAC,WAAW,EAAE,EAAE;4BAEpB,KAAkB,UAAa,EAAb,KAAA,IAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;gCAA5B,IAAI,KAAK,SAAA;gCAEV,OAAO,GAAG;oCACN,aAAa;oCACb,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oCAC3B,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oCAC3B,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oCAC1B,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;iCAC7B,CAAC;gCAEF,KAAK,GAAG,KAAK,CAAC;gCAEd,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;6BAExC;yBACJ;wBAED,OAAO,IAAI,CAAC;oBAChB,CAAC,CAAC,CAAC;iBACN;aACJ;YAED,OAAO,QAAQ,CAAC;QACpB,CAAC;QAED,mCAAY,GAAZ,UAAa,IAAsC;YAE/C,IAAI,yBAAyB,EAAE,uBAAuB,EAAE,sBAAsB,EAAE,yBAAyB,CAAC;YAE1G,IAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAE1D,IAAI,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,CAAC;YAEtD,+EAA+E;YAE/E,yBAAyB,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChF,uBAAuB,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YAC/G,sBAAsB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;YACnF,yBAAyB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,EAAE,UAAU,CAAC,CAAC;YAE1F,OAAO;gBACH,uBAAuB,GAAG,CAAC,CAAC,uBAAuB,GAAG,yBAAyB,CAAC,GAAG,CAAC,CAAC;gBACrF,yBAAyB,GAAG,CAAC,CAAC,yBAAyB,GAAG,sBAAsB,CAAC,GAAG,CAAC,CAAC;aACzF,CAAA;QACL,CAAC;QAAA,CAAC;QAEK,mCAAY,GAAnB,UAAoB,qBAAqB,EAAE,YAAY;YACnD,IAAI,qBAAqB,GAAG,IAAI,CAAC,yBAAyB,CAAC,qBAAqB,EAAE,YAAY,CAAC,CAAC;YAChG,KAA2B,UAAqB,EAArB,+CAAqB,EAArB,mCAAqB,EAArB,IAAqB,EAAE;gBAA7C,IAAI,cAAc,8BAAA;gBACnB,KAAyB,UAAc,EAAd,iCAAc,EAAd,4BAAc,EAAd,IAAc,EAAE;oBAApC,IAAI,YAAY,uBAAA;oBACjB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;iBACxC;aACJ;QACL,CAAC;QAEM,gDAAyB,GAAhC,UAAiC,qBAAqB,EAAE,YAAyB;YAC7E,IAAI,QAAQ,GAAG,EAAE,CAAC;YAElB,IAAI,UAAU,GAAG,CAAC,YAAY,KAAK,IAAI,CAAC,CAAC;YAEzC,IAAI,UAAU,EAAE;gBACZ,uDAAuD;gBACvD,EAAE;gBACF,yDAAyD;gBACzD,oCAAoC;gBACpC,iBAAiB;gBACjB,gDAAgD;gBAChD,YAAY;gBACZ,SAAS;gBACT,IAAI,UAAU,GAAG,CAAC,CAAC;gBACnB,QAAQ,CAAC,IAAI,CACT,IAAI,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAC5C,CAAA;gBACD,IAAI;aACP;iBAAM;gBACH,KAAkB,UAA0B,EAA1B,KAAA,YAAY,CAAC,WAAW,EAAE,EAA1B,cAA0B,EAA1B,IAA0B,EAAE;oBAAzC,IAAI,KAAK,SAAA;oBACV,QAAQ,CAAC,IAAI,CACT,IAAI,CAAC,wBAAwB,CACzB,IAAI,CAAC,mBAAmB,CACpB,KAAK,CACR,CACJ,CACJ,CAAA;iBACJ;aACJ;YAED,OAAO,QAAQ,CAAA;QACnB,CAAC;QAEM,qDAA8B,GAArC,UAAsC,gBAAgB;YAClD,IAAI,iBAAiB,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,CAAC;YAEzE,iBAAiB,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,yBAAyB,EAAE,CAAC,CAAC;YAC9E,eAAe,GAAG,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;YAC/D,gBAAgB,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;YACnD,cAAc,GAAG,IAAI,CAAC,2BAA2B,EAAE,CAAC;YAEpD,OAAO,CAAC,iBAAiB,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,CAAC,CAAA;QACjF,CAAC;QAEM,wDAAiC,GAAxC,UAAyC,gBAAgB;YACrD,IAAI,iBAAiB,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,CAAC;YAEzE,iBAAiB,GAAG,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;YACjE,eAAe,GAAG,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;YAC/D,gBAAgB,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;YACnD,cAAc,GAAG,IAAI,CAAC,2BAA2B,EAAE,CAAC;YAEpD,OAAO,CAAC,iBAAiB,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,CAAC,CAAA;QACjF,CAAC;QAEM,uDAAgC,GAAvC,UAAwC,gBAAgB;YACpD,IAAI,iBAAiB,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,CAAC;YAEzE,iBAAiB,GAAG,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;YACjE,eAAe,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,0BAA0B,EAAE,CAAC,CAAC;YAC7E,gBAAgB,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;YACnD,cAAc,GAAG,IAAI,CAAC,2BAA2B,EAAE,CAAC;YAEpD,OAAO,CAAC,iBAAiB,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,CAAC,CAAA;QACjF,CAAC;QAED,mFAAmF;QAC5E,qCAAc,GAArB,UAAsB,qBAAqC,EAAE,oBAAoB,EAAE,SAAS,EAAE,YAAY;YAEtG,IAAI,KAAK,EAAE,KAAK,CAAC;YAEjB,IAAI,gBAAgB,CAAC;YAErB,IAAI,SAAS,CAAC,UAAU,EAAE,EAAE;gBACxB,qDAAqD;gBACrD,oEAAoE;gBACpE,uFAAuF;gBACvF,4BAA4B;gBAC5B,MAAM;gBACN,gBAAgB,GAAG,SAAS,CAAC,wBAAwB,CACjD,oBAAoB,CACvB,CAAC;aACL;iBAAM;gBACH,IAAI,qBAAqB,CAAC,IAAI,EAAE;oBAC5B,gBAAgB,GAAG;wBACf,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,EAAE;wBAC3C,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,EAAE;qBAC9C,CAAA;iBACJ;qBAAM;oBACH,KAAK,GAAG,qBAAqB,CAAC,iBAAiB,EAAE,CAAC;oBAElD,IAAI,aAAa,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;oBAElC,KAAK,GAAG,YAAY,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;oBAEvD,gBAAgB,GAAG,SAAS,CAAC,wBAAwB,CACjD,KAAK,CACR,CAAC;iBACL;aACJ;YAED,wBAAwB;YACxB,oCAAoC;YACpC,EAAE;YACF,WAAW;YACX,6DAA6D;YAC7D,gBAAgB;YAChB,SAAS;YACT,IAAI;YAEJ,IAAI,sBAAsB,GAAG,IAAI,CAAC,8BAA8B,CAAC,gBAAgB,CAAC,CAAC;YACnF,IAAI,yBAAyB,GAAG,IAAI,CAAC,iCAAiC,CAAC,gBAAgB,CAAC,CAAC;YACzF,IAAI,wBAAwB,GAAG,IAAI,CAAC,gCAAgC,CAAC,gBAAgB,CAAC,CAAC;YAEvF,sBAAsB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YAC5C,sBAAsB,GAAG,sBAAsB,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;YAErE,yBAAyB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YAC/C,yBAAyB,GAAG,yBAAyB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;YAEzE,wBAAwB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YAC9C,wBAAwB,GAAG,wBAAwB,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;YAE1E,KAAuB,UAA6E,EAA7E,MAAC,sBAAsB,EAAE,yBAAyB,EAAE,wBAAwB,CAAC,EAA7E,cAA6E,EAA7E,IAA6E,EAAE;gBAAjG,IAAI,UAAU,SAAA;gBACf,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;aACtC;QACL,CAAC;QACL,mBAAC;IAAD,CAAC,AA/PD,CAAkC,MAAM,GA+PvC;IA/PY,mBAAY,eA+PxB,CAAA;AACL,CAAC,EA5bgB,MAAM,GAAN,cAAM,KAAN,cAAM,QA4btB","sourcesContent":["import TreeModel = require(\"tree-model\");\nimport {message, message as m} from \"../message/messenger\"\nimport {clip, clip as c} from \"../clip/clip\";\nimport {note as n} from \"../note/note\";\nimport {live} from \"../live/live\";\nimport * as _ from \"lodash\";\nimport {segment} from \"../segment/segment\";\nimport {algorithm} from \"../train/algorithm\";\nimport {iterate} from \"../train/iterate\";\nimport {parse} from \"../parse/parse\";\n\nexport namespace window {\n\n    import LiveClipVirtual = live.LiveClipVirtual;\n    import Messenger = message.Messenger;\n    import Segment = segment.Segment;\n    import Clip = clip.Clip;\n    import Algorithm = algorithm.Algorithm;\n    import MatrixIterator = iterate.MatrixIterator;\n    import StructParse = parse.StructParse;\n\n    const red = [255, 0, 0];\n    const white = [255, 255, 255];\n    const black = [0, 0, 0];\n    const region_yellow = [254, 254, 10];\n    const region_green = [33, 354, 6];\n    const region_red = [251, 1, 6];\n    const blue = [10, 10, 251];\n\n    interface Temporal {\n        get_message_render_region_past(interval_current);\n        get_message_render_region_present(interval_current);\n        get_message_render_region_future(interval_current);\n    }\n\n    export abstract class Window {\n        list_clips: Clip[];\n        height: number;\n        width: number;\n        messenger: Messenger;\n        length_beats: number;\n        algorithm: Algorithm;\n\n        protected constructor(height, width, messenger, algorithm) {\n            this.height = height;\n            this.width = width;\n            this.messenger = messenger;\n            this.algorithm = algorithm;\n        }\n\n        public clear() {\n            let msg_clear = [\"clear\"];\n            this.messenger.message(msg_clear);\n        }\n\n        // because it's a *list* of clips\n        public coord_to_index_clip(coord): number {\n            if (this.algorithm.b_targeted()) {\n                return 0\n            } else {\n                if (coord[0] === -1) {\n                    return 0\n                } else {\n                    return coord[0] + 1\n                }\n            }\n        }\n\n        public initialize_clips(algorithm: Algorithm, segments: Segment[]) {\n            let list_clips = [];\n            let depth = algorithm.get_depth();\n            let beat_start_song = segments[0].beat_start;\n            let beat_end_song = segments[segments.length - 1].beat_end;\n\n            if (algorithm.b_targeted()) {\n                let clip_dao_virtual = new LiveClipVirtual([]);\n                clip_dao_virtual.beat_start = beat_start_song;\n                clip_dao_virtual.beat_end = beat_end_song;\n                let clip_virtual = new c.Clip(clip_dao_virtual);\n                list_clips.push(clip_virtual)\n            } else {\n                for (let i in _.range(0, depth + 1)) {\n                    let clip_dao_virtual = new LiveClipVirtual([]);\n                    clip_dao_virtual.beat_start = beat_start_song;\n                    clip_dao_virtual.beat_end = beat_end_song;\n                    let clip_virtual = new c.Clip(clip_dao_virtual);\n                    list_clips.push(clip_virtual)\n                }\n            }\n\n            this.list_clips = list_clips;\n        }\n\n        public set_length_beats(beats) {\n            this.length_beats = beats;\n        }\n\n        public add_notes_to_clip(notes_to_add_to_clip, coord_current) {\n            let index_clip = this.coord_to_index_clip(coord_current);\n            for (let note of notes_to_add_to_clip) {\n                this.list_clips[index_clip].append(note);\n            }\n        }\n\n        add_note_to_clip_root(note) {\n            this.list_clips[0].set_notes(\n                [note]\n            )\n        }\n\n        get_messages_render_clip(index_clip: number) {\n            let clip_virtual = this.list_clips[index_clip];\n            let quadruplets = [];\n            for (let node of clip_virtual.get_notes_within_loop_brackets()) {\n                quadruplets.push(this.get_position_quadruplet(node, index_clip));\n            }\n            return quadruplets.map(function (tuplet) {\n                let message = <any>[\"paintrect\"].concat(tuplet);\n                message = message.concat(black);\n                return message;\n            })\n        };\n\n        get_position_quadruplet(node: TreeModel.Node<n.Note>, index_clip: number) {\n            var dist_from_left_beat_start, dist_from_top_note_top, dist_from_left_beat_end, dist_from_top_note_bottom;\n\n            dist_from_left_beat_start = this.get_dist_from_left(node.model.note.beat_start);\n            dist_from_left_beat_end = this.get_dist_from_left(node.model.note.beat_start + node.model.note.beats_duration);\n            dist_from_top_note_top = this.get_dist_from_top(node.model.note.pitch, index_clip);\n            dist_from_top_note_bottom = this.get_dist_from_top(node.model.note.pitch - 1, index_clip);\n\n            return [dist_from_left_beat_start, dist_from_top_note_top, dist_from_left_beat_end, dist_from_top_note_bottom]\n        };\n\n        get_dist_from_top(pitch: number, index_clip: number): number {\n            var clip = this.list_clips[index_clip];\n            let offset = index_clip;\n            // TODO: make this configurable\n            if (false) {\n                offset = this.list_clips.length - 1 - index_clip;\n\n            }\n            var dist = (clip.get_pitch_max() - pitch) * this.get_height_note(index_clip);\n            return dist + (this.get_height_clip() * offset);\n        };\n\n        beat_to_pixel = function (beat: number): number {\n            let num_pixels_width = this.width;\n            return beat * (num_pixels_width / this.length_beats);\n        };\n\n        get_dist_from_left(beat: number): number {\n            return this.beat_to_pixel(beat);\n        };\n\n        get_offset_pixel_leftmost(): number {\n            return 0;\n        }\n\n        get_offset_pixel_topmost(): number {\n            return 0;\n        }\n\n        get_offset_pixel_rightmost(): number {\n            return this.width;\n        }\n\n        get_offset_pixel_bottommost(): number {\n            return this.height;\n        }\n\n        get_height_clip(): number {\n            return this.height / this.list_clips.length;\n        };\n\n        get_height_note(index_clip: number): number {\n            let clip = this.list_clips[index_clip];\n            let ambitus = clip.get_ambitus();\n            let dist_pitch = ambitus[1] - ambitus[0] + 1;\n\n            // TODO: fix this hack for getting a margin around the note\n            if (dist_pitch === 1) {\n                dist_pitch = 3;\n            }\n            return this.get_height_clip() / dist_pitch;\n        };\n    }\n\n    export interface Renderable {\n        render_regions(\n            iterator_matrix_train,\n            matrix_target_iterator\n        )\n\n        render_notes(\n            history_user_input\n        )\n    }\n\n    export class MatrixWindow extends Window implements Temporal {\n\n        constructor(height, width, messenger, algorithm) {\n            super(height, width, messenger, algorithm);\n        }\n\n        public render(iterator_matrix_train, notes_target_current, algorithm, parse_matrix) {\n            this.clear();\n\n            // let notes, coord;\n            //\n            // if (algorithm.b_targeted()) {\n            //     coord = iterator_matrix_train.get_coord_current();\n            //     let target_iterator = matrix_target_iterator[coord[0]][coord[1]];\n            //     notes = target_iterator.current().iterator_subtarget.subtargets.map((subtarget) => {\n            //         return subtarget.note\n            //     });\n            // } else {\n            //     coord = iterator_matrix_train.get_coord_current();\n            //     let coord_segment = [0, coord[1]];\n            //     notes = parse_matrix.get_roots_at_coord(coord_segment);\n            // }\n\n            this.render_regions(\n                iterator_matrix_train,\n                notes_target_current,\n                algorithm,\n                parse_matrix\n            );\n\n            if (algorithm.b_targeted()) {\n                this.render_clips(\n                    iterator_matrix_train,\n                    null\n                );\n            } else {\n                this.render_trees(\n                    parse_matrix\n                );\n                this.render_clips(\n                    iterator_matrix_train,\n                    parse_matrix\n                );\n            }\n        }\n\n        public render_trees(parse_matrix) {\n            let messages_render_trees = this.get_messages_render_trees(parse_matrix);\n            for (let message_tree of messages_render_trees) {\n                this.messenger.message(message_tree)\n            }\n        }\n\n        public get_messages_render_trees(parse_matrix) {\n\n            let color: number[];\n            let messages: any[] = [];\n            let message: any[];\n\n            for (let coord of parse_matrix.coords_roots) {\n                let roots_parse_tree;\n                if (coord[0] === -1) {\n                    roots_parse_tree = [parse_matrix.get_root()]\n                } else {\n                    roots_parse_tree = parse_matrix.get_notes_at_coord(coord);\n                }\n\n                for (let root of roots_parse_tree) {\n                    root.walk((node)=>{\n\n                        if (node.hasChildren()) {\n\n                            for (let child of node.children) {\n\n                                message = [\n                                    \"linesegment\",\n                                    this.get_centroid(child)[0],\n                                    this.get_centroid(child)[1],\n                                    this.get_centroid(node)[0],\n                                    this.get_centroid(node)[1]\n                                ];\n\n                                color = black;\n\n                                messages.push(message.concat(color));\n\n                            }\n                        }\n\n                        return true;\n                    });\n                }\n            }\n\n            return messages;\n        }\n\n        get_centroid(node: TreeModel.Node<n.NoteRenderable>): number[] {\n\n            let dist_from_left_beat_start, dist_from_left_beat_end, dist_from_top_note_top, dist_from_top_note_bottom;\n\n            let coord_clip = node.model.note.get_coordinates_matrix();\n\n            let index_clip = this.coord_to_index_clip(coord_clip);\n\n            // TODO: determine how to get the index of the clip from just depth of the node\n\n            dist_from_left_beat_start = this.get_dist_from_left(node.model.note.beat_start);\n            dist_from_left_beat_end = this.get_dist_from_left(node.model.note.beat_start + node.model.note.beats_duration);\n            dist_from_top_note_top = this.get_dist_from_top(node.model.note.pitch, index_clip);\n            dist_from_top_note_bottom = this.get_dist_from_top(node.model.note.pitch - 1, index_clip);\n\n            return [\n                dist_from_left_beat_end - ((dist_from_left_beat_end - dist_from_left_beat_start) / 2),\n                dist_from_top_note_bottom - ((dist_from_top_note_bottom - dist_from_top_note_top) / 2)\n            ]\n        };\n\n        public render_clips(iterator_matrix_train, parse_matrix) {\n            let messages_render_clips = this.get_messages_render_clips(iterator_matrix_train, parse_matrix);\n            for (let messages_notes of messages_render_clips) {\n                for (let message_note of messages_notes) {\n                    this.messenger.message(message_note);\n                }\n            }\n        }\n\n        public get_messages_render_clips(iterator_matrix_train, parse_matrix: StructParse): any[][] {\n            let messages = [];\n\n            let b_targeted = (parse_matrix === null);\n\n            if (b_targeted) {\n                // for (let i of iterator_matrix_train.get_history()) {\n                //\n                //     let index_clip: number = this.coord_to_index_clip(\n                //         MatrixIterator.get_coord(\n                //             i,\n                //             iterator_matrix_train.num_columns\n                //         )\n                //     );\n                let index_clip = 0;\n                messages.push(\n                    this.get_messages_render_clip(index_clip)\n                )\n                // }\n            } else {\n                for (let coord of parse_matrix.get_history()) {\n                    messages.push(\n                        this.get_messages_render_clip(\n                            this.coord_to_index_clip(\n                                coord\n                            )\n                        )\n                    )\n                }\n            }\n\n            return messages\n        }\n\n        public get_message_render_region_past(interval_current) {\n            let offset_left_start, offset_top_start, offset_left_end, offset_top_end;\n\n            offset_left_start = this.get_dist_from_left(this.get_offset_pixel_leftmost());\n            offset_left_end = this.get_dist_from_left(interval_current[0]);\n            offset_top_start = this.get_offset_pixel_topmost();\n            offset_top_end = this.get_offset_pixel_bottommost();\n\n            return [offset_left_start, offset_top_start, offset_left_end, offset_top_end]\n        }\n\n        public get_message_render_region_present(interval_current) {\n            let offset_left_start, offset_top_start, offset_left_end, offset_top_end;\n\n            offset_left_start = this.get_dist_from_left(interval_current[0]);\n            offset_left_end = this.get_dist_from_left(interval_current[1]);\n            offset_top_start = this.get_offset_pixel_topmost();\n            offset_top_end = this.get_offset_pixel_bottommost();\n\n            return [offset_left_start, offset_top_start, offset_left_end, offset_top_end]\n        }\n\n        public get_message_render_region_future(interval_current) {\n            let offset_left_start, offset_top_start, offset_left_end, offset_top_end;\n\n            offset_left_start = this.get_dist_from_left(interval_current[1]);\n            offset_left_end = this.get_dist_from_left(this.get_offset_pixel_rightmost());\n            offset_top_start = this.get_offset_pixel_topmost();\n            offset_top_end = this.get_offset_pixel_bottommost();\n\n            return [offset_left_start, offset_top_start, offset_left_end, offset_top_end]\n        }\n\n        // public render_regions(iterator_matrix_train: MatrixIterator, notes, algorithm) {\n        public render_regions(iterator_matrix_train: MatrixIterator, notes_target_current, algorithm, parse_matrix) {\n\n            let notes, coord;\n\n            let interval_current;\n\n            if (algorithm.b_targeted()) {\n                // coord = iterator_matrix_train.get_coord_current();\n                // let target_iterator = matrix_target_iterator[coord[0]][coord[1]];\n                // notes = target_iterator.current().iterator_subtarget.subtargets.map((subtarget) => {\n                //     return subtarget.note\n                // });\n                interval_current = algorithm.determine_region_present(\n                    notes_target_current\n                );\n            } else {\n                if (iterator_matrix_train.done) {\n                    interval_current = [\n                        parse_matrix.root.model.note.get_beat_end(),\n                        parse_matrix.root.model.note.get_beat_end()\n                    ]\n                } else {\n                    coord = iterator_matrix_train.get_coord_current();\n\n                    let coord_segment = [0, coord[1]];\n\n                    notes = parse_matrix.get_notes_at_coord(coord_segment);\n\n                    interval_current = algorithm.determine_region_present(\n                        notes\n                    );\n                }\n            }\n\n            // let interval_current;\n            // if (iterator_matrix_train.done) {\n            //\n            // } else {\n            //     interval_current = algorithm.determine_region_present(\n            //         notes\n            //     );\n            // }\n\n            let quadruplet_region_past = this.get_message_render_region_past(interval_current);\n            let quadruplet_region_present = this.get_message_render_region_present(interval_current);\n            let quadruplet_region_future = this.get_message_render_region_future(interval_current);\n\n            quadruplet_region_past.unshift('paintrect');\n            quadruplet_region_past = quadruplet_region_past.concat(region_green);\n\n            quadruplet_region_present.unshift('paintrect');\n            quadruplet_region_present = quadruplet_region_present.concat(region_red);\n\n            quadruplet_region_future.unshift('paintrect');\n            quadruplet_region_future = quadruplet_region_future.concat(region_yellow);\n\n            for (let quadruplet of [quadruplet_region_past, quadruplet_region_present, quadruplet_region_future]) {\n                this.messenger.message(quadruplet);\n            }\n        }\n    }\n}"]}